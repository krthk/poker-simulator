/**
 * Equity-Based Hand Rankings - EXACT PROFESSIONAL STANDARD
 * 
 * Hand ranking order matches the exact professional standard provided
 * Combined with Monte Carlo equity data (50,000 iterations per hand)
 * This represents the most precise professional poker hand strength analysis
 */

// Hand equity data: [hand, equity_percentage]
const HAND_EQUITY_DATA: [string, number][] = [
  ['AA', 84.72],
  ['KK', 82.13],
  ['QQ', 79.34],
  ['JJ', 77.15],
  ['TT', 74.63],
  ['AKs', 59.04],
  ['99', 71.83],
  ['AQs', 58.55],
  ['AKo', 56.36],
  ['AJs', 58.38],
  ['KQs', 56.70],
  ['88', 69.08],
  ['ATs', 57.86],
  ['AQo', 56.20],
  ['KJs', 56.68],
  ['QJs', 56.28],
  ['KTs', 56.45],
  ['AJo', 56.06],
  ['KQo', 54.12],
  ['QTs', 55.70],
  ['A9s', 56.27],
  ['77', 66.36],
  ['ATo', 55.66],
  ['JTs', 56.26],
  ['KJo', 53.98],
  ['A8s', 56.25],
  ['K9s', 54.34],
  ['QJo', 53.71],
  ['A7s', 55.35],
  ['KTo', 53.29],
  ['Q9s', 53.69],
  ['A5s', 54.94],
  ['66', 63.96],
  ['QTo', 53.02],
  ['A6s', 54.60],
  ['J9s', 54.00],
  ['A9o', 53.89],
  ['A4s', 54.42],
  ['T9s', 54.38],
  ['K8s', 53.08],
  ['JTo', 53.56],
  ['A3s', 53.58],
  ['K7s', 52.69],
  ['A8o', 53.68],
  ['Q8s', 52.78],
  ['K9o', 51.49],
  ['A2s', 52.26],
  ['J8s', 52.53],
  ['K6s', 52.54],
  ['55', 61.15],
  ['T8s', 52.98],
  ['A7o', 52.61],
  ['98s', 53.04],
  ['Q9o', 51.02],
  ['K5s', 51.35],
  ['A5o', 52.62],
  ['J9o', 51.24],
  ['Q7s', 51.35],
  ['T9o', 52.10],
  ['A6o', 51.91],
  ['K4s', 50.65],
  ['K8o', 50.46],
  ['A4o', 51.62],
  ['J7s', 51.85],
  ['Q6s', 50.78],
  ['T7s', 51.75],
  ['K3s', 49.62],
  ['97s', 51.81],
  ['87s', 51.94],
  ['A3o', 50.66],
  ['44', 57.96],
  ['Q5s', 50.21],
  ['K7o', 50.30],
  ['K2s', 49.36],
  ['Q8o', 49.79],
  ['J8o', 50.35],
  ['Q4s', 49.49],
  ['A2o', 50.08],
  ['T8o', 50.63],
  ['K6o', 49.49],
  ['J6s', 49.61],
  ['76s', 51.11],
  ['T6s', 49.97],
  ['98o', 50.79],
  ['86s', 50.94],
  ['Q3s', 49.14],
  ['96s', 50.52],
  ['J5s', 49.26],
  ['K5o', 48.84],
  ['Q2s', 47.71],
  ['J4s', 48.91],
  ['33', 55.03],
  ['Q7o', 48.55],
  ['65s', 49.91],
  ['K4o', 47.94],
  ['75s', 49.76],
  ['J7o', 48.56],
  ['J3s', 48.20],
  ['T7o', 48.87],
  ['T5s', 48.64],
  ['85s', 49.19],
  ['Q6o', 47.97],
  ['87o', 49.39],
  ['95s', 49.06],
  ['97o', 49.30],
  ['K3o', 47.06],
  ['T4s', 48.33],
  ['J2s', 47.09],
  ['54s', 48.49],
  ['Q5o', 47.06],
  ['64s', 48.45],
  ['T3s', 47.76],
  ['K2o', 46.33],
  ['22', 52.06],
  ['74s', 47.78],
  ['Q4o', 46.39],
  ['T2s', 46.47],
  ['84s', 47.49],
  ['76o', 48.42],
  ['J6o', 46.79],
  ['94s', 47.53],
  ['86o', 48.08],
  ['T6o', 47.39],
  ['53s', 47.02],
  ['96o', 47.87],
  ['93s', 46.56],
  ['Q3o', 46.42],
  ['J5o', 46.73],
  ['63s', 46.40],
  ['43s', 46.26],
  ['92s', 46.12],
  ['Q2o', 44.95],
  ['73s', 46.18],
  ['J4o', 45.62],
  ['65o', 47.26],
  ['83s', 45.84],
  ['75o', 46.80],
  ['52s', 45.43],
  ['82s', 45.35],
  ['85o', 46.60],
  ['T5o', 45.78],
  ['J3o', 44.99],
  ['95o', 46.02],
  ['42s', 44.68],
  ['54o', 45.82],
  ['62s', 44.83],
  ['T4o', 45.26],
  ['J2o', 44.16],
  ['72s', 44.72],
  ['64o', 45.13],
  ['32s', 43.84],
  ['T3o', 44.45],
  ['74o', 45.24],
  ['84o', 44.66],
  ['T2o', 43.65],
  ['94o', 44.56],
  ['53o', 44.23],
  ['93o', 44.08],
  ['63o', 43.82],
  ['43o', 43.27],
  ['92o', 42.88],
  ['73o', 43.75],
  ['83o', 43.25],
  ['52o', 42.76],
  ['82o', 42.44],
  ['42o', 41.39],
  ['62o', 42.10],
  ['72o', 41.33],
  ['32o', 40.81]
];

// Pre-computed ranking from strongest to weakest (exact professional order)
export const EQUITY_BASED_RANKING: readonly string[] = [
  'AA',
  'KK',
  'QQ',
  'JJ',
  'TT',
  'AKs',
  '99',
  'AQs',
  'AKo',
  'AJs',
  'KQs',
  '88',
  'ATs',
  'AQo',
  'KJs',
  'QJs',
  'KTs',
  'AJo',
  'KQo',
  'QTs',
  'A9s',
  '77',
  'ATo',
  'JTs',
  'KJo',
  'A8s',
  'K9s',
  'QJo',
  'A7s',
  'KTo',
  'Q9s',
  'A5s',
  '66',
  'QTo',
  'A6s',
  'J9s',
  'A9o',
  'A4s',
  'T9s',
  'K8s',
  'JTo',
  'A3s',
  'K7s',
  'A8o',
  'Q8s',
  'K9o',
  'A2s',
  'J8s',
  'K6s',
  '55',
  'T8s',
  'A7o',
  '98s',
  'Q9o',
  'K5s',
  'A5o',
  'J9o',
  'Q7s',
  'T9o',
  'A6o',
  'K4s',
  'K8o',
  'A4o',
  'J7s',
  'Q6s',
  'T7s',
  'K3s',
  '97s',
  '87s',
  'A3o',
  '44',
  'Q5s',
  'K7o',
  'K2s',
  'Q8o',
  'J8o',
  'Q4s',
  'A2o',
  'T8o',
  'K6o',
  'J6s',
  '76s',
  'T6s',
  '98o',
  '86s',
  'Q3s',
  '96s',
  'J5s',
  'K5o',
  'Q2s',
  'J4s',
  '33',
  'Q7o',
  '65s',
  'K4o',
  '75s',
  'J7o',
  'J3s',
  'T7o',
  'T5s',
  '85s',
  'Q6o',
  '87o',
  '95s',
  '97o',
  'K3o',
  'T4s',
  'J2s',
  '54s',
  'Q5o',
  '64s',
  'T3s',
  'K2o',
  '22',
  '74s',
  'Q4o',
  'T2s',
  '84s',
  '76o',
  'J6o',
  '94s',
  '86o',
  'T6o',
  '53s',
  '96o',
  '93s',
  'Q3o',
  'J5o',
  '63s',
  '43s',
  '92s',
  'Q2o',
  '73s',
  'J4o',
  '65o',
  '83s',
  '75o',
  '52s',
  '82s',
  '85o',
  'T5o',
  'J3o',
  '95o',
  '42s',
  '54o',
  '62s',
  'T4o',
  'J2o',
  '72s',
  '64o',
  '32s',
  'T3o',
  '74o',
  '84o',
  'T2o',
  '94o',
  '53o',
  '93o',
  '63o',
  '43o',
  '92o',
  '73o',
  '83o',
  '52o',
  '82o',
  '42o',
  '62o',
  '72o',
  '32o'
] as const;

// Get equity for a specific hand
export function getHandEquity(hand: string): number {
  const entry = HAND_EQUITY_DATA.find(([h]) => h === hand);
  return entry ? entry[1] : 50.0;
}

// Validate that the ranking includes all 169 hands
export function validateRanking(): { isValid: boolean; errors: string[] } {
  const errors: string[] = [];
  
  if (EQUITY_BASED_RANKING.length !== 169) {
    errors.push(`Expected 169 hands, got ${EQUITY_BASED_RANKING.length}`);
  }
  
  const uniqueHands = new Set(EQUITY_BASED_RANKING);
  if (uniqueHands.size !== EQUITY_BASED_RANKING.length) {
    errors.push('Duplicate hands found');
  }
  
  if (EQUITY_BASED_RANKING[0] !== 'AA') {
    errors.push('AA should be the strongest hand');
  }
  
  return {
    isValid: errors.length === 0,
    errors
  };
}
